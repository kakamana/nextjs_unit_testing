[{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\__tests__\\imageUplaod.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\__tests__\\inputField.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\__tests__\\profileForm.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\__tests__\\profilePreview.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\__tests__\\socialFields.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\__tests__\\textarea.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\components\\ProfileForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\components\\ProfilePreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\components\\input-fields\\Icons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\components\\input-fields\\ImageUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\components\\input-fields\\InputField.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\components\\input-fields\\Label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\components\\input-fields\\SocialFields.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\components\\input-fields\\TextArea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\jest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\jest.setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\scripts\\security-report.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":14,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":29},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":19,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":39}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const fs = require('fs');\r\nconst path = require('path');\r\nconst puppeteer = require('puppeteer');\r\n\r\nasync function main() {\r\n  const artifactsDir = path.join(__dirname, '..', 'artifacts', 'security');\r\n  if (!fs.existsSync(artifactsDir)) {\r\n    fs.mkdirSync(artifactsDir, { recursive: true });\r\n  }\r\n\r\n  const eslintJsonPath = path.join(artifactsDir, 'eslint.json');\r\n  const zapHtmlPath = path.join(artifactsDir, 'zap_report.html');\r\n  const zapJsonPath = path.join(artifactsDir, 'zap_report.json');\r\n\r\n  const eslintData = fs.existsSync(eslintJsonPath)\r\n    ? JSON.parse(fs.readFileSync(eslintJsonPath, 'utf-8'))\r\n    : null;\r\n  const zapHtml = fs.existsSync(zapHtmlPath)\r\n    ? fs.readFileSync(zapHtmlPath, 'utf-8')\r\n    : '<p>ZAP report not found. Run security:zap.</p>';\r\n  const zapJson = fs.existsSync(zapJsonPath)\r\n    ? JSON.parse(fs.readFileSync(zapJsonPath, 'utf-8'))\r\n    : null;\r\n\r\n  const summary = {\r\n    eslintIssues: eslintData ? eslintData.length : 0,\r\n    zapAlerts: zapJson ? zapJson.length || (zapJson.site && zapJson.site[0]?.alerts?.length) || 0 : 0,\r\n  };\r\n\r\n  const html = `\r\n  <html>\r\n    <head>\r\n      <meta charset=\"utf-8\" />\r\n      <title>Security Assessment Report</title>\r\n      <style>\r\n        body { font-family: Arial, sans-serif; margin: 24px; }\r\n        h1 { color: #0ea5e9; }\r\n        h2 { color: #111827; }\r\n        .section { margin-bottom: 24px; }\r\n        pre { background: #f5f5f5; padding: 12px; border-radius: 6px; overflow: auto; }\r\n        .summary { background: #e0f2fe; padding: 12px; border-radius: 6px; }\r\n      </style>\r\n    </head>\r\n    <body>\r\n      <h1>Security Assessment Report</h1>\r\n      <div class=\"summary\">\r\n        <p><strong>ESLint Security Issues:</strong> ${summary.eslintIssues}</p>\r\n        <p><strong>ZAP Alerts:</strong> ${summary.zapAlerts}</p>\r\n      </div>\r\n\r\n      <div class=\"section\">\r\n        <h2>OWASP ZAP Baseline Report</h2>\r\n        ${zapHtml}\r\n      </div>\r\n\r\n      <div class=\"section\">\r\n        <h2>ESLint Security Findings (JSON)</h2>\r\n        <pre>${eslintData ? JSON.stringify(eslintData, null, 2) : 'No eslint.json found'}</pre>\r\n      </div>\r\n    </body>\r\n  </html>`;\r\n\r\n  const outHtml = path.join(artifactsDir, 'security-report.html');\r\n  fs.writeFileSync(outHtml, html, 'utf-8');\r\n  console.log('Wrote', outHtml);\r\n\r\n  const browser = await puppeteer.launch({ args: ['--no-sandbox'] });\r\n  const page = await browser.newPage();\r\n  await page.setContent(html, { waitUntil: 'networkidle0' });\r\n  const outPdf = path.join(artifactsDir, 'security-report.pdf');\r\n  await page.pdf({ path: outPdf, format: 'A4' });\r\n  console.log('Wrote', outPdf);\r\n  await browser.close();\r\n}\r\n\r\nmain().catch((err) => {\r\n  console.error(err);\r\n  process.exit(1);\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\security-tests\\unit\\headers.test.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":5,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":5,"endColumn":48,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[161,204],"text":"// @ts-expect-error headers exists per NextConfig"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import nextConfig from '../../next.config';\r\n\r\ndescribe('Security Headers', () => {\r\n  it('defines headers() with required security headers', async () => {\r\n    // @ts-ignore headers exists per NextConfig\r\n    const result = await nextConfig.headers?.();\r\n    expect(Array.isArray(result)).toBe(true);\r\n    const allHeaders = result?.[0]?.headers ?? [];\r\n\r\n    const keys = allHeaders.map((h: { key: string }) => h.key);\r\n    expect(keys).toEqual(\r\n      expect.arrayContaining([\r\n        'Strict-Transport-Security',\r\n        'X-Content-Type-Options',\r\n        'X-Frame-Options',\r\n        'Referrer-Policy',\r\n        'Permissions-Policy',\r\n        'Content-Security-Policy',\r\n      ])\r\n    );\r\n\r\n    const csp = allHeaders.find((h: { key: string }) => h.key === 'Content-Security-Policy');\r\n    expect(csp?.value).toContain(\"default-src 'self'\");\r\n    expect(csp?.value).toContain(\"script-src 'self'\");\r\n    expect(csp?.value).toContain(\"frame-ancestors 'none'\");\r\n  });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Projects\\Nextjs\\TestDrivenDevelopment\\nextjs_unit_testing\\types\\global.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]